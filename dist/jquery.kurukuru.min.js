/*! jQuery plugin kurukuru - v0.2.0 - 2014-12-11 https://github.com/nak0yui/jquery.kurukuru.js Copyright (c) 2014 nak; Licensed MIT, GPL */
!function(a){"use strict";var b={debug:!1,width:480,height:327,defaultCurrent:3,pixelChange:8,loadingHtml:"<p>Now Loading...</p>",image:[],selectorZIndex:0,maskZIndex:1e3},c=function(a){a.preventDefault?a.preventDefault():a.stop(),a.returnValue=!1,a.stopPropagation()},d=function(a){var b,c=a.originalEvent;return b=c.targetTouches?c.targetTouches[0].pageX:a.pageX},e=function(b,c,d){var e,f={images:[],length:b.length,onLoaded:c,onProcessed:d,count:0,errorCount:0},g=function(){f.count++,a.isFunction(f.onProcessed)&&f.onProcessed.apply(f),f.count>=f.length&&a.isFunction(f.onLoaded)&&f.onLoaded.apply(f)},h=function(){g()},i=function(){f.errorCount++,g()};for(e=0;e<f.length;e++){var j=a("<img>");j.load(h),j.error(i),j.attr("src",b[e]),f.images.push(j)}return f};a.preLoadImage=function(a,b,c){return e(a,b,c)};var f=function(e,f){var g,h={},i=a.extend(!0,b,f),j=a(e),k=i.defaultCurrent,l=!1,m=-1,n=-1,o=!1,p={init:function(){var b={width:i.width,height:i.height};j.css(b).css({position:"relative",zIndex:i.selectorZIndex}),g=a('<div class="mask"></div>').css(b).css({backgroundColor:"white",filter:"alpha(opacity=0)",opacity:0,position:"absolute",zIndex:i.maskZIndex}),s(),j.append(a(i.loadingHtml).addClass("loading").css({zIndex:i.maskZIndex+1})),j.append(g),q(i.images)},update:function(b,c){return o===!1?!1:("undefined"!=typeof c?(a.extend(!0,i,c),h.destroy(),h.init()):(g.hide(),h.cleanupOnlyNotCurrentImage(),q(b),h.cleanupOnlyCurrentImage(),g.show()),!0)},cleanupOnlyNotCurrentImage:function(){j.children("img").filter(function(a){return a!==k}).remove()},cleanupOnlyCurrentImage:function(){j.children("img:first").remove()},cleanup:function(){j.children("img").remove()},destroy:function(){j.html("")}},q=function(b){r(),o=!1,a.preLoadImage(b,function(){l=this.images,a.each(l,function(a){this.css({position:"absolute",zIndex:i.selectorZIndex+1}),j.append(this),k!==a&&this.hide(),o=!0,g.unbind("mousedown"),g.unbind("touchstart"),g.bind("mousedown",t.mouseDown),g.bind("touchstart",t.mouseDown)}),s()})},r=function(){j.children(".loading").show()},s=function(){j.children(".loading").hide()},t={mouseDown:function(b){var e=d(b);c(b),o&&(m=e,n=k,a(document).bind("mouseup",t.mouseUp),a(document).bind("mousemove",t.mouseMove),a(document).bind("touchmove",t.mouseMove),a(document).bind("touchend",t.mouseUp))},mouseUp:function(b){c(b),a(document).unbind("mouseup",t.mouseUp),a(document).unbind("mousemove",t.mouseMove),a(document).unbind("touchmove",t.mouseMove),a(document).unbind("touchend",t.mouseUp),n=-1},mouseMove:function(a){var b=d(a);if(l[k]){var c=0>b-m?-1:1,e=Math.abs(b-m),f=l.length,g=e/i.pixelChange;g=Math.floor(g%l.length),l[k].hide(),k=n+c*g,(k>=f||0>k)&&(k+=-1*c*f),l[k].show()}}};return a.extend(h,p),h};a.fn.kurukuru=function(b){var c;return this.each(function(){c=f(this,b),c.init(),a(this).data("kurukuru",c)})}}(jQuery);